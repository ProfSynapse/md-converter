# Railway Configuration
# Location: /mnt/c/Users/Joseph/Documents/Code/md-converter/railway.toml
#
# This file configures the deployment settings for Railway platform.

[build]
# Use Dockerfile for building
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
# Start command (Gunicorn with dynamic PORT from Railway)
# Using sh -c to ensure proper environment variable expansion
startCommand = "sh -c 'gunicorn --bind 0.0.0.0:$PORT --workers 2 --threads 2 --timeout 30 --access-logfile - --error-logfile - --log-level info wsgi:app'"

# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

# Health check configuration
healthcheckPath = "/health"
healthcheckTimeout = 10

# Number of replicas (can be scaled up)
numReplicas = 1

[env]
# Environment variables with defaults
PORT = { default = "8080" }
PYTHON_VERSION = { default = "3.12" }
LOG_LEVEL = { default = "INFO" }
MAX_FILE_SIZE = { default = "10485760" }
FLASK_ENV = { default = "production" }
